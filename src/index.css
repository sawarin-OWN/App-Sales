@tailwind base;
@tailwind components;
@tailwind utilities;

html {
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
  /* ใช้ความสูงแบบ Dynamic Viewport Height */
  height: 100vh !important;
  height: 100dvh !important;
  max-height: 100vh !important;
  max-height: 100dvh !important;
  overflow-x: hidden !important;
  overflow-y: hidden !important;
  /* สำคัญ: ป้องกันการดึงหน้าจอลง (Pull-to-refresh) ที่จะเผยให้เห็น Address bar */
  overscroll-behavior-y: none !important;
  overscroll-behavior: none !important;
  -webkit-tap-highlight-color: transparent !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
}

body {
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
  /* ใช้ความสูงแบบ Dynamic Viewport Height */
  height: 100vh !important;
  height: 100dvh !important;
  max-height: 100vh !important;
  max-height: 100dvh !important;
  overflow-x: hidden !important;
  overflow-y: hidden !important;
  /* สำคัญ: ป้องกันการดึงหน้าจอลง (Pull-to-refresh) ที่จะเผยให้เห็น Address bar */
  overscroll-behavior-y: none !important;
  overscroll-behavior: none !important;
  font-family: 'Sarabun', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: #f0fdf4; /* KebYod: โทนเขียวอ่อนให้เข้ากับไอคอน */
  -webkit-tap-highlight-color: transparent !important;
  /* Prevent text size adjustment on iOS */
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  /* Smooth scrolling */
  -webkit-overflow-scrolling: touch;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
}

/* ไม่ให้ #root เป็น scroll container เพื่อให้ header (fixed) ไม่อยู่ใน scroll — แก้มือถือเนื้อหาซ้อนแถบเมนู */
#root {
  width: 100% !important;
  height: 100vh !important;
  height: 100dvh !important;
  max-height: 100vh !important;
  max-height: 100dvh !important;
  overflow-x: hidden !important;
  overflow-y: hidden !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  display: flex !important;
  flex-direction: column !important;
}

/* Utility class for full viewport height (like example) */
.h-dvh {
  height: 100vh;
  height: 100dvh;
}

/* Safe Area for Mobile - iOS Notch & Status Bar */
.pt-safe {
  padding-top: max(env(safe-area-inset-top, 0px), 8px);
}

.pb-safe {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.pl-safe {
  padding-left: env(safe-area-inset-left, 0px);
}

.pr-safe {
  padding-right: env(safe-area-inset-right, 0px);
}

/* Header Safe Area Support - ป้องกันทับ Status Bar, พื้นหลังทึบไม่ให้เนื้อหาเลื่อนทับ (มือถือ) */
header,
header.nav-bar-opaque {
  top: calc(env(safe-area-inset-top, 0px) + 8px) !important;
  padding-top: 8px !important;
  left: 0 !important;
  right: 0 !important;
  position: fixed !important;
  z-index: 9999 !important;
  background-color: #ffffff !important; /* ขาว */
  background-image: none !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
  opacity: 1 !important;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  isolation: isolate;
}
/* ชั้นพื้นหลังแบบ ::before เพื่อบังคับทึบบนมือถือ */
header::before {
  content: '';
  position: absolute;
  inset: 0;
  background-color: #ffffff;
  z-index: -1;
  pointer-events: none;
}
/* บังคับพื้นหลังทึบในแถบแท็บเมนู — โทนน้ำเงิน */
header > div:last-of-type {
  background-color: #12467d !important;
  background-image: none !important;
  box-shadow: inset 0 0 0 9999px #12467d !important;
}

/* Main ต้องอยู่ใต้ header (z-index น้อยกว่า) */
main {
  margin-top: calc(env(safe-area-inset-top, 0px) + 136px) !important;
  position: relative;
  z-index: 0;
}

/* บนมือถือ: บังคับ Navbar อยู่ชั้นบนสุด + พื้นหลังทึบ ไม่ให้เนื้อหาซ้อนทับ */
@media (max-width: 768px) {
  header {
    z-index: 9999 !important;
    background-color: #ffffff !important;
    background-image: none !important;
    box-shadow: inset 0 0 0 9999px #ffffff !important;
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    will-change: transform;
  }
  header::before {
    background-color: #ffffff !important;
  }
  header > div:nth-child(1) {
    background-color: #ffffff !important;
    box-shadow: inset 0 0 0 9999px #ffffff !important;
  }
  header > div:last-of-type {
    background-color: #12467d !important;
    box-shadow: inset 0 0 0 9999px #12467d !important;
  }
  main {
    z-index: 0 !important;
  }
}

/* Fullscreen support for mobile - Based on working example */
@media (max-width: 768px) {
  html {
    width: 100% !important;
    /* ใช้ความสูงแบบ Dynamic Viewport Height */
    height: 100vh !important;
    height: 100dvh !important;
    max-height: 100vh !important;
    max-height: 100dvh !important;
    overflow-x: hidden !important;
    overflow-y: hidden !important;
    /* ป้องกันการดึงหน้าจอลง (Pull-to-refresh) */
    overscroll-behavior-y: none !important;
    overscroll-behavior: none !important;
    -webkit-tap-highlight-color: transparent !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  body {
    width: 100% !important;
    /* ใช้ความสูงแบบ Dynamic Viewport Height */
    height: 100vh !important;
    height: 100dvh !important;
    max-height: 100vh !important;
    max-height: 100dvh !important;
    overflow-x: hidden !important;
    overflow-y: hidden !important;
    /* ป้องกันการดึงหน้าจอลง (Pull-to-refresh) */
    overscroll-behavior-y: none !important;
    overscroll-behavior: none !important;
    touch-action: pan-y !important;
    -webkit-overflow-scrolling: touch !important;
    margin: 0 !important;
    padding: 0 !important;
    -webkit-tap-highlight-color: transparent !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
  }
  
  #root {
    width: 100% !important;
    height: 100vh !important;
    height: 100dvh !important;
    max-height: 100vh !important;
    max-height: 100dvh !important;
    overflow-x: hidden !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    position: relative !important;
    display: block !important;
    visibility: visible !important;
  }
  
  /* ป้องกันการเลื่อนเมื่อ focus input (iOS Safari) */
  input:focus,
  textarea:focus,
  select:focus {
    scroll-margin-top: 0 !important;
    scroll-margin-bottom: 0 !important;
    /* ป้องกันการเลื่อนหน้าจอ */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }
  
  /* Standalone mode - Force fullscreen (PWA mode) */
  @media (display-mode: standalone) {
    html {
      height: 100vh !important;
      height: 100dvh !important;
      overflow: hidden !important;
      position: fixed !important;
      width: 100% !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
    }
    
    body {
      height: 100vh !important;
      height: 100dvh !important;
      overflow: hidden !important;
      position: fixed !important;
      width: 100% !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
    }
    
    #root {
      height: 100vh !important;
      height: 100dvh !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      position: relative !important;
      width: 100% !important;
      -webkit-overflow-scrolling: touch !important;
    }
  }
  
  /* iOS Safari standalone mode detection */
  @supports (-webkit-touch-callout: none) {
    /* This is iOS */
    html.standalone-mode,
    body.standalone-mode {
      height: 100vh !important;
      height: 100dvh !important;
      overflow: hidden !important;
      position: fixed !important;
      width: 100% !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
    }
    
    html.standalone-mode #root,
    body.standalone-mode #root {
      height: 100vh !important;
      height: 100dvh !important;
      overflow-y: auto !important;
      position: relative !important;
      width: 100% !important;
      -webkit-overflow-scrolling: touch !important;
    }
  }
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}

.mobile-input {
  font-size: 16px;
  padding-top: 12px;
  padding-bottom: 12px;
}

@media (max-width: 768px) {
  .desktop-only {
    display: none !important;
  }
}

@media (min-width: 769px) {
  .mobile-only {
    display: none !important;
  }
}


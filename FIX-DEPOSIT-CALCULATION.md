# üîß ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏ù‡∏≤‡∏Å‡∏™‡∏∞‡∏™‡∏°

## üìã ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö

‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏ù‡∏≤‡∏Å‡∏™‡∏∞‡∏™‡∏°‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
- ‡∏™‡∏≤‡∏Ç‡∏≤ RS003
- ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î 05/01/2569-16/01/2569 = 8,434 ‡∏ö‡∏≤‡∏ó
- ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î 05/01/2569-16/01/2569 = 3,627 ‡∏ö‡∏≤‡∏ó
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å

**‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≤‡∏°‡∏™‡∏π‡∏ï‡∏£:**
```
‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô (‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢) - ‡∏¢‡∏≠‡∏î‡∏ù‡∏≤‡∏Å‡πÅ‡∏•‡πâ‡∏ß
= 8,434 - 3,627 - 0
= 4,807 ‡∏ö‡∏≤‡∏ó
```

**‡πÅ‡∏ï‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•:** -72 ‡∏ö‡∏≤‡∏ó ‚ùå

## ‚úÖ ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏

1. **‡πÉ‡∏ä‡πâ `getDisplayValues()` ‡πÅ‡∏ó‡∏ô `getValues()`**
   - `getDisplayValues()` ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà format ‡πÅ‡∏•‡πâ‡∏ß (string) ‡πÄ‡∏ä‡πà‡∏ô "8,434.00"
   - ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ `parseFloat()` ‡∏≠‡∏≤‡∏à‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î

2. **‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**
   - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å Sheets ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô Date object ‡∏´‡∏£‡∏∑‡∏≠ string
   - ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô YYYY-MM-DD format ‡πÄ‡∏™‡∏°‡∏≠

## üîß ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å `getDisplayValues()` ‡πÄ‡∏õ‡πá‡∏ô `getValues()`

**‡∏Å‡πà‡∏≠‡∏ô:**
```javascript
var salesData = salesSheet.getDataRange().getDisplayValues();
var expenseData = expenseSheet.getDataRange().getDisplayValues();
var depositData = depositSheet.getDataRange().getDisplayValues();
```

**‡∏´‡∏•‡∏±‡∏á:**
```javascript
var salesData = salesSheet.getDataRange().getValues();
var expenseData = expenseSheet.getDataRange().getValues();
var depositData = depositSheet.getDataRange().getValues();
```

### 2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç

**‡∏Å‡πà‡∏≠‡∏ô:**
```javascript
var cash = parseFloat(salesData[i][cashColIndex]) || 0;
var expenseAmount = parseFloatSafe(expenseData[i][expenseAmountColIndex]) || 0;
```

**‡∏´‡∏•‡∏±‡∏á:**
```javascript
var cash = typeof salesData[i][cashColIndex] === 'number' 
  ? salesData[i][cashColIndex] 
  : (parseFloat(salesData[i][cashColIndex]) || 0);

var expenseAmount = typeof expenseData[i][expenseAmountColIndex] === 'number' 
  ? expenseData[i][expenseAmountColIndex] 
  : (parseFloat(expenseData[i][expenseAmountColIndex]) || 0);
```

### 3. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà

**‡∏Å‡πà‡∏≠‡∏ô:**
```javascript
var salesDate = salesData[i][dateColIndex];
var normalizedSalesDate = normalizeDate(salesDate);
```

**‡∏´‡∏•‡∏±‡∏á:**
```javascript
var salesDateValue = salesData[i][dateColIndex];
var salesDate = '';

if (salesDateValue instanceof Date) {
  var year = salesDateValue.getFullYear();
  var month = String(salesDateValue.getMonth() + 1).padStart(2, '0');
  var day = String(salesDateValue.getDate()).padStart(2, '0');
  salesDate = year + '-' + month + '-' + day;
} else if (typeof salesDateValue === 'string') {
  salesDate = normalizeDate(salesDateValue);
} else {
  continue; // ‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
}

var normalizedSalesDate = normalizeDate(salesDate);
```

### 4. ‡πÄ‡∏û‡∏¥‡πà‡∏° Console Log ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Debug

```javascript
console.log('[GAS] getDepositInfo - Daily calculation:', {
  date: normalizedSalesDate,
  cash: cash,
  expenses: dayExpenses,
  dailyDeposit: dailyDeposit
});
```

## üìù ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

- `backend/Code.js` - ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getDepositInfo`:
  - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å `getDisplayValues()` ‡πÄ‡∏õ‡πá‡∏ô `getValues()`
  - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
  - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
  - ‡πÄ‡∏û‡∏¥‡πà‡∏° console.log ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö debug

## üöÄ Deploy

### 1. Deploy Google Apps Script

1. ‡πÄ‡∏õ‡∏¥‡∏î Google Apps Script Editor
2. Copy ‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å `backend/Code.js` ‡πÑ‡∏õ‡∏ß‡∏≤‡∏á
3. Deploy > Manage deployments > Edit > New version > Deploy
4. Description: `Fix deposit calculation - use getValues() instead of getDisplayValues()`

### 2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö

1. ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ "‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å": https://sales-report-theta.vercel.app/deposits
2. Refresh ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö (Ctrl+F5)
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
   - ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏ù‡∏≤‡∏Å‡∏™‡∏∞‡∏™‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏™‡∏π‡∏ï‡∏£: ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô (‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢) - ‡∏¢‡∏≠‡∏î‡∏ù‡∏≤‡∏Å‡πÅ‡∏•‡πâ‡∏ß

## üìä ‡∏™‡∏π‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì

```
‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô = ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ (‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô)
‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å‡∏™‡∏∞‡∏™‡∏° = ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô - ‡∏¢‡∏≠‡∏î‡∏ù‡∏≤‡∏Å‡πÅ‡∏•‡πâ‡∏ß
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 05/01/2569: ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î 500, ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ 100 ‚Üí ‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å = 400
- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 06/01/2569: ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î 600, ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ 150 ‚Üí ‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å = 450
- ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏ù‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô = 400 + 450 = 850
- ‡∏¢‡∏≠‡∏î‡∏ù‡∏≤‡∏Å‡πÅ‡∏•‡πâ‡∏ß = 0
- **‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏ù‡∏≤‡∏Å‡∏™‡∏∞‡∏™‡∏° = 850 - 0 = 850** ‚úÖ

## ‚ö†Ô∏è ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

- ‡∏ï‡πâ‡∏≠‡∏á Deploy Google Apps Script ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏°‡∏µ‡∏ú‡∏•
- Refresh ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏≤‡∏á cache
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console (F12) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π log ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô
